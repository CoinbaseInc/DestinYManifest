<?xml version="1.0"  encoding="UTF-8" ?>
<!--
************************************************************************
JSBSim Cessna 172P with 3D cockpit.

Started October 23 2001 by John Check, fgpanels@rockfish.net

Detailed version January, 2015
http://forum.flightgear.org/viewtopic.php?f=4&t=25157

- Main model based on the original c172p by Jon Check
- Enhanced model by thevirtualfer
- Small details and systems by ludomotico (Juan Vera) and gsagostinho 

Notice this version relays heavily on the original c172p!
Many files from the original c172p directory are included in this file.

************************************************************************
-->

<PropertyList include="Aircraft/Generic/Human/Include/walker-include.xml" >

 <sim>

  <description>Cessna 172P Skyhawk (1981 model, detailed)</description>
  <long-description>The Cessna 172 Skyhawk is a four-seat, single-engine, high-wing fixed-wing aircraft. 
      First flown in 1955 and still in production, more Cessna 172s have been built than any other aircraft.
      This version has more detailed textures, instruments and models than the default version.
  </long-description>
  
  <fr>
      <long-description>Le Cessna 172 Skyhawk est un avion quadriplace, monomoteur à aile haute. 
        Il effectua son premier vol en 1955 et est toujours en production, plus de Cessna 172 ont été construits que tout autres avions.
        </long-description>
  </fr>
  
  <es>
    <long-description>La Cessna 172 Skyhawk es un avión de cuatro plazas, monomotor y de ala alta.
      Se empezó a producir en 1955 y, con equipos modernizados, aún sigue en producción.
      La Cessna 172 es el avión del que unidades se han construido en la historia.
      This version has more detailed textures, instruments and models than the default version.
      </long-description>
  </es>
  
  <tags>
      <tag>ga</tag>
      <tag>cessna</tag>
      <tag>piston</tag>
      <tag>single-engine</tag>
      <tag>fixed-gear</tag>
  </tags>
  
  <author>David Megginson</author>
  <status>early production</status>
  <rating>
    <FDM type="int">3</FDM>
    <systems type="int">4</systems>
    <model type="int">5</model>
    <cockpit type="int">4</cockpit>
  </rating>


  <flight-model archive="y">jsb</flight-model>
  <aero archive="y">c172p</aero>

  <allow-toggle-cockpit type="bool">true</allow-toggle-cockpit>

  <model>
    <path archive="y">Aircraft/c172p-detailed/Models/c172p-detailed.xml</path>

    <livery>
      <file type="string">D-EEQA</file>
      <index type="int">0</index>
    </livery>

    <liverytail>
      <file type="string">D-EEQA</file>
      <index type="int">0</index>
    </liverytail>

    <liverywing>
      <file type="string">D-EEQA</file>
      <index type="int">0</index>
    </liverywing>

    <c172p>
      <immat type="bool">false</immat>
      <fairing1 type="bool">true</fairing1>
      <fairing2 type="bool">false</fairing2>
      <fairing3 type="bool">false</fairing3>
    </c172p>
    <hide-yoke type="bool">false</hide-yoke>
    
    <crew>
      <pilot n="0">
	<pose include = "Models/Human/pose-pilot.xml"></pose>
        <character>0</character>
        <outfit>0</outfit>
        <equipment>0</equipment>
      </pilot>
      <pilot n="1">
	<pose include = "Models/Human/pose-copilot.xml"></pose>
        <character>0</character>
        <outfit>0</outfit>
        <equipment>0</equipment>
      </pilot>
    </crew>
    
    <!-- an exit for the walker -->
    <map>
      <default_exit>
        <x-offset-m type="float">-0.35</x-offset-m>
        <y-offset-m type="float">-0.84</y-offset-m>
      </default_exit>
    </map>
  </model>

  <startup>
	  <splash-texture>Aircraft/c172p-detailed/splash.png</splash-texture>
  </startup>

  <!-- hide the 2D panel -->
 
  <panel>
   <visibility type="bool" archive="y">false</visibility>
  </panel>

  <!-- position the pilot viewpoint and angle -->
 
  <view>
   <internal type="bool" archive="y">true</internal>
   <config>
     <x-offset-m archive="y" type="double">-0.21</x-offset-m>
     <y-offset-m archive="y" type="double">0.235</y-offset-m>
     <z-offset-m archive="y" type="double">0.36</z-offset-m>
     <pitch-offset-deg type="double">-12</pitch-offset-deg>
   </config>
  </view>

  <systems>
    <autopilot>
      <path>/Aircraft/c172p/Systems/KAP140.xml</path>
    </autopilot>
    <property-rule n="100">
      <name>FiltersOnly</name>
      <path>Aircraft/c172p/Systems/NAVandGSfilters.xml</path>
    </property-rule>
    <electrical>
      <!-- null electrical system path here so we can use a nasal based -->
      <!-- model defined later in the nasal section of this file. -->
      <path></path>
    </electrical>
     
    <!-- needed by shadows in ALS: http://forum.flightgear.org/viewtopic.php?f=4&t=25157&start=75#p232120 -->
    <property-rule n="101">
      <name>gear_agl-m</name>
      <path>Aircraft/c172p-detailed/Systems/gearAGL.xml</path>
    </property-rule>
  </systems>

  <sound>
   <path archive="y">/Aircraft/c172p/c172-sound.xml</path>
  </sound>

  <help include="c172-help.xml"/>
  
  <checklists include="c172-checklists.xml"/>

  <tutorials include="Tutorials/c172-tutorials.xml"/>
  
  <dimensions>
    <radius-m type="double">5</radius-m>
  </dimensions>
  <aircraft-class type="string">ga</aircraft-class>
  <aircraft-operator type="string">NONE</aircraft-operator>

  <multiplay>
      <chat_display>1</chat_display>
      <generic>
        <float n="0" alias="/sim/model/door-positions/rightDoor/position-norm"/>
        <float n="1" alias="/sim/model/door-positions/leftDoor/position-norm"/>
        <float n="2" alias="/sim/model/door-positions/baggageDoor/position-norm"/>
        <int type="int">0</int>
        <int type="int">0</int>
        <int type="int">0</int>
        <int type="int">0</int>
        <int type="int">0</int>
        <int type="int">0</int>
      </generic>
  </multiplay>

  <flight-recorder>
    <replay-config type="int">0</replay-config>
    <config n="0" include="/Aircraft/Generic/flightrecorder/generic-piston-propeller-1.xml">
      <name type="string">C172p Flight Recorder</name>
    </config>
  </flight-recorder>

  <menubar include="Dialogs/c172p-menu.xml"/>
  <instrumentation n="0">
    <path>/Aircraft/c172p/Systems/instrumentation.xml</path>
  </instrumentation>
 </sim>

 <!-- trim for level cruise -->

 <controls>
  <flight>
   <aileron-trim type="double">0.027</aileron-trim>
   <rudder-trim type="double">0.0</rudder-trim>
  </flight>
  <engines>
    <!-- MOD: more realistic initial configuration. Notice master-bat and master-alt are switched on in electrical.nas! We fix this in nasal after loading the aircraft -->
   <engine n="0">
    <magnetos type="int">0</magnetos>
    <master-bat type="bool">false</master-bat>
    <master-alt type="bool">false</master-alt>
    <mixture-lever>0</mixture-lever>
    <throttle>0</throttle>
    <primer>0</primer>
    <primer-lever>0</primer-lever>
   </engine>
   <!-- ENDMOD -->
  </engines>
  <gear>
    <brake-parking type="bool">true</brake-parking>
  </gear>
  <!--lighting The state of these switches is saved >
   <landing-lights type="bool">false</landing-lights>
   <taxi-light type="bool">false</taxi-light>
   <strobe type="bool">false</strobe>
   <beacon type="bool">false</beacon>
   <nav-lights type="bool">false</nav-lights>
  </lighting-->
  <switches>
   <!--master-avionics type="bool">true</master-avionics-->
   <starter type="bool">false</starter>
  </switches>
 </controls>

 <autopilot>
  <KAP140>
   <settings>
    <auto-pitch-trim type="bool">true</auto-pitch-trim>
   </settings>
  </KAP140>
 </autopilot>

 <consumables>
  <fuel>
   <tank n="0">
    <name>LeftTank</name>
    <level-gal_us type="double">20</level-gal_us>
    <selected type="bool">true</selected>
   </tank>
   <tank n="1">
    <name>RightTank</name>
    <level-gal_us type="double">20</level-gal_us>
    <selected type="bool">true</selected>
   </tank>
  </fuel>
 </consumables>

 <instrumentation>
  <kma20 include="/Aircraft/Instruments-3d/kma20/kma20init.xml"/>
  <attitude-indicator>
   <config>
    <tumble-flag archive="y" type="bool">true</tumble-flag>
   </config>
  </attitude-indicator>
  <encoder>
   <serviceable type="bool">true</serviceable>
  </encoder>
  <adf n="0">
    <ident-audible type="bool">false</ident-audible>
    <volume type="double">0.7</volume>
  </adf>
  <comm n="0">
    <power-btn type="bool">1</power-btn>
  </comm>
  <nav n="0">
    <volume type="double">0.7</volume>
  </nav>
  <comm n="1">
    <power-btn type="bool">1</power-btn>
  </comm>
  <nav n="1">
    <volume type="double">0.7</volume>
  </nav>
  <magnetic-compass>
    <pitch-offset-deg type="double">-2.7</pitch-offset-deg>
  </magnetic-compass>
 </instrumentation>

 <engines>
  <engine>
   <rpm type="double">0</rpm>
   <magnetos type="int">0</magnetos>
   <mixture type="double">0</mixture>
   <mixture-lever type="double">0</mixture-lever>
   <running type="bool">false</running>
  </engine>
 </engines>

 <nasal>
 
    <c172p>
      <file>Nasal/liveries.nas</file>
      <file>/Aircraft/c172p/Nasal/immat.nas</file>
      <file>/Aircraft/c172p/Nasal/doors.nas</file>
      <file>/Aircraft/c172p/Nasal/light.nas</file>
      <file>/Aircraft/c172p/Nasal/tanks.nas</file>
      <file>/Aircraft/c172p/Nasal/kma20.nas</file>
      <file>/Aircraft/c172p/Nasal/ki266.nas</file>
      <file>Nasal/engine.nas</file>
      <script><![CDATA[
        ki266.new(0);
        aircraft.data.add( "engines/engine[0]/egt-bug-norm" );
	# save the state of the avionics
	# Radio control panel (according to its documentation)
	aircraft.data.add(
          "instrumentation/kma20/test",
          "instrumentation/kma20/auto",
          "instrumentation/kma20/com1",
          "instrumentation/kma20/com2",
          "instrumentation/kma20/nav1",
          "instrumentation/kma20/nav2",
          "instrumentation/kma20/adf",
          "instrumentation/kma20/dme",
          "instrumentation/kma20/mkr",
          "instrumentation/kma20/sens",
          "instrumentation/kma20/knob"
        );
	# COMM1 (according to its documentation)
	aircraft.data.add(
          "instrumentation/comm[0]/power-btn",
          "instrumentation/comm[0]/volume",
          "instrumentation/comm[0]/frequencies/selected-mhz",
          "instrumentation/comm[0]/frequencies/standby-mhz",
          "instrumentation/comm[0]/test-btn",
          "instrumentation/nav[0]/audio-btn",
          "instrumentation/nav[0]/power-btn",
          "instrumentation/nav[0]/frequencies/selected-mhz",
          "instrumentation/nav[0]/frequencies/standby-mhz",
        );
	# COMM2 (according to its documentation)
	aircraft.data.add(
          "instrumentation/comm[1]/power-btn",
          "instrumentation/comm[1]/volume",
          "instrumentation/comm[1]/frequencies/selected-mhz",
          "instrumentation/comm[1]/frequencies/standby-mhz",
          "instrumentation/comm[1]/test-btn",
          "instrumentation/nav[1]/audio-btn",
          "instrumentation/nav[1]/power-btn",
          "instrumentation/nav[1]/frequencies/selected-mhz",
          "instrumentation/nav[1]/frequencies/standby-mhz",
        );
	# DME saves power-btn in ki266.nas
	# ADF saves its properties in ki87.nas
	# TRANSPONDER (KT76A)
	aircraft.data.add(
	  "instrumentation/transponder/inputs/knob-mode",
	  "instrumentation/transponder/inputs/ident-btn",
	  "instrumentation/transponder/inputs/digit[0]",
	  "instrumentation/transponder/inputs/digit[1]",
	  "instrumentation/transponder/inputs/digit[2]",
	  "instrumentation/transponder/inputs/digit[3]",
	  "instrumentation/transponder/inputs/dimming-norm",
	);
	# Hobbs meter is saved in Nasal/engine.nas
    # Save switches
    aircraft.data.add(
      "/controls/lighting/beacon",
      "/controls/lighting/instruments-norm",
      "/controls/lighting/landing-lights",
      "/controls/lighting/nav-lights",
      "/controls/lighting/panel-norm",
      "/controls/lighting/strobe",
      "/controls/lighting/taxi-light"
    );
    # Other controls
    aircraft.data.add(
      "/controls/anti-ice/engine/carb-heat",
      "/controls/anti-ice/pitot-heat",
      "/consumables/fuel/tank/selected",
      "/consumables/fuel/tank[1]/selected"
    );
    
      ]]></script>
    </c172p>

  <electrical>
   <file>/Aircraft/c172p/Nasal/c172-electrical.nas</file>
  </electrical>
  <kap140>
   <file>/Aircraft/Generic/kap140.nas</file>
   <!-- We can set some variables that might be
        aircraft specific. We must do it after the file
        to override the ones that are in the .nas file.-->
   <script><![CDATA[
                    headingNeedleDeflection = "/instrumentation/nav/heading-needle-deflection";
                    gsNeedleDeflection = "/instrumentation/nav/gs-needle-deflection-norm";
                    staticPressure = "systems/static/pressure-inhg";

                    # electrical.nas switches on MASTER and ALT always!
                    # I prefer not changing electrical.nas because other versions of the c172p in FG may prefer that
init_electrical_detailed = func {
    # set initial positions for main switches
    setprop("/controls/engines/engine[0]/master-bat", 0);
    setprop("/controls/engines/engine[0]/master-alt", 0);
    setprop("/controls/switches/master-avionics", 0);
}
                    settimer(init_electrical_detailed, 1.0);
    ]]>
   </script>
  </kap140>
  <kr87>
    <file>/Aircraft/c172p/Nasal/kr87.nas</file>
  </kr87>
  
  <!-- pilot-movment>
    <file>Aircraft/Generic/Human/Nasal/pilot-movment.nas</file>
    <script>
var head_x = "sim/model/crew/pilot[0]/pose/position/limb[2]/x-deg";
var head_y = "sim/model/crew/pilot[0]/pose/position/limb[2]/y-deg";
var head_z = "sim/model/crew/pilot[0]/pose/position/limb[2]/z-deg";
    </script>
  </pilot-movment -->
  
  <tyresmoke>
   <file>Aircraft/c172p-detailed/Nasal/tyresmoke.nas</file>
  </tyresmoke>
  
 </nasal>
 
 <payload>
  <weight>
   <name type="string">Pilot</name>
   <weight-lb alias="/fdm/jsbsim/inertia/pointmass-weight-lbs[0]"/>
   <arm-in alias="/fdm/jsbsim/inertia/pointmass-location-X-inches[0]"/>
   <min-lb type="double">0.0</min-lb>
   <max-lb type="double">300.0</max-lb>
  </weight>
  <weight>
   <name type="string">Co-Pilot</name>
   <weight-lb alias="/fdm/jsbsim/inertia/pointmass-weight-lbs[1]"/>
   <arm-in alias="/fdm/jsbsim/inertia/pointmass-location-X-inches[0]"/>
   <min-lb type="double">0.0</min-lb>
   <max-lb type="double">300.0</max-lb>
  </weight>
  <weight>
   <name type="string">Left Passenger</name>
   <weight-lb alias="/fdm/jsbsim/inertia/pointmass-weight-lbs[2]"/>
   <arm-in alias="/fdm/jsbsim/inertia/pointmass-location-X-inches[0]"/>
   <min-lb type="double">0.0</min-lb>
   <max-lb type="double">300.0</max-lb>
  </weight>
  <weight>
   <name type="string">Right Passenger</name>
   <weight-lb alias="/fdm/jsbsim/inertia/pointmass-weight-lbs[3]"/>
   <arm-in alias="/fdm/jsbsim/inertia/pointmass-location-X-inches[0]"/>
   <min-lb type="double">0.0</min-lb>
   <max-lb type="double">300.0</max-lb>
  </weight>
  <weight>
   <name type="string">Baggage</name>
   <weight-lb alias="/fdm/jsbsim/inertia/pointmass-weight-lbs[4]"/>
   <arm-in alias="/fdm/jsbsim/inertia/pointmass-location-X-inches[0]"/>
   <min-lb type="double">0.0</min-lb>
   <max-lb type="double">150.0</max-lb> <!-- WARNING: Max baggage "by the book" is 120lbs or less! -->
  </weight>
 </payload>

 <limits>
  <mass-and-balance>
   <maximum-ramp-mass-lbs>2407</maximum-ramp-mass-lbs>
   <maximum-takeoff-mass-lbs>2400</maximum-takeoff-mass-lbs>
   <maximum-landing-mass-lbs>2400</maximum-landing-mass-lbs>
   <cg>
    <dimension type="string">in</dimension>
    <limit>
     <entry>
      <position type="double">35.0</position>
      <mass-lbs type="double">1450</mass-lbs>
     </entry>
     <entry>
      <position type="double">35.0</position>
      <mass-lbs type="double">1950</mass-lbs>
     </entry>
     <entry>
      <position type="double">41</position>
      <mass-lbs type="double">2550</mass-lbs>
     </entry>
     <entry>
      <position type="double">47.2</position>
      <mass-lbs type="double">2550</mass-lbs>
     </entry>
     <entry>
      <position type="double">47.2</position>
      <mass-lbs type="double">1450</mass-lbs>
     </entry>
    </limit>
   </cg>
  </mass-and-balance>
 </limits>

 <input>
  <keyboard>
   <key n="76">
    <name>L</name>
    <desc>Decrease Panel lighting</desc>
    <repeatable type="bool">true</repeatable>
    <binding>
     <command>property-adjust</command>
     <property>controls/lighting/instruments-norm</property>
     <step>-0.1</step>
     <min>0</min>
     <max>1.0</max>
     <wrap>0</wrap>
    </binding>
   </key>
   <key n="108">
    <name>l</name>
    <desc>Increase Panel lighting</desc>
    <repeatable type="bool">true</repeatable>
    <binding>
     <command>property-adjust</command>
     <property>controls/lighting/instruments-norm</property>
     <step>0.1</step>
     <min>0</min>
     <max>1.0</max>
     <wrap>0</wrap>
    </binding>
   </key>
  </keyboard> 
 </input>

 <gear>
	<gear n="0">
      <tyre-smoke type="int">0</tyre-smoke>
      <sprayspeed-ms type="double">0</sprayspeed-ms>
      <spray-density type="double">0</spray-density>
    </gear>
    <gear n="1">
      <tyre-smoke type="int">0</tyre-smoke>
      <sprayspeed-ms type="double">0</sprayspeed-ms>
      <spray-density type="double">0</spray-density>
    </gear>
    <gear n="2">
      <tyre-smoke type="int">0</tyre-smoke>
      <sprayspeed-ms type="double">0</sprayspeed-ms>
      <spray-density type="double">0</spray-density>
    </gear>
  </gear>
  
</PropertyList>
